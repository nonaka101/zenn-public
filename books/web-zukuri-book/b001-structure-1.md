---
title: "📄B001：構成について(1)"
---

## このページについて

ここでは２回に分けて、静的サイトの構成を考えていきます。

１回目である今回は、WordPress はどのようにページ（記事）を管理しているかについて説明します。  

:::message

WordPress を知らない方向けの説明になります。ページテンプレートや その階層について既にご存知の場合は、本項は飛ばしてもらって問題ありません。

:::

## WordPress の中身について

ここでは WordPress とは何であり、どのようなことをしているか、ザックリとお話します。

:::message alert

私が書籍等から得たイメージとなります。なので正確とは言えず、あくまでイメージの話であることをご了承ください。詳細について知りたい方は、公式ページや書籍等を参照してください。

:::

### WordPress とは

WordPressは、コンテンツ管理システム（CMS：Contents Management System） の一種です。

コンテンツ管理システムとは、Webサイトのコンテンツを簡単に作成、編集、管理できるシステムを指します。Webサイトの専門知識がなくても、 テキストエディタのような感覚でコンテンツを編集でき、画像の挿入やレイアウト変更なども直感的に行うことができます。

### 内部的な処理

上記で説明した通り、WordPressはコンテンツ（記事のテキスト、画像 など）を管理し、それをWebページとして生成してくれます。記事データや、タクソノミー（タグやカテゴリなど）、記事に載せる画像など、様々な情報（コンテンツ）は **SQL** によるデータベースで管理されています。

このコンテンツは 単にブログのような記事として出力されるだけではありません。例えば ある期間内の記事をまとめたり、特定のカテゴリのみをまとめたページを作ることができます（≒ アーカイブページ）。他にも、検索ページを用意して、データベース上にある記事群から条件に一致したものを抽出することもできます。

そのため、WordPress は扱う内容によって適切なレイアウトでWebページを生成できるように、「投稿用」「アーカイブ用」「検索用」といった 様々なページテンプレートを持っています。

WordPress がページを生成するまでの流れは、下記のようなイメージです。

1. 閲覧者からページの要求を受け取る
2. DB（データベース）にアクセスし、要求されたコンテンツを取得する
3. コンテンツを、要求された内容に沿うページテンプレートに当てはめ、ページを生成する
4. 生成されたページを閲覧者に渡す

![閲覧者が特定ページの閲覧を要求、DBといくつかのページテンプレートを組み合わせてHTMLファイルを生成し、送り返す流れ](/images/books/web-zukuri/flow-create-page-01.png)
*閲覧要求からページ表示されるまでの大まかな流れ*

WordPress の「テーマ」とは、ざっくり言ってしまうと、この**ページテンプレート**を指します。コンテンツの管理は WordPress 本体の話であり、それをどのようにWebページに落とし込むかが、テーマの役割となります。なので、WordPressのテーマを自作するといった場合、このページテンプレートを作成することがメインとなります。

ここからは必要なページテンプレートを確認するために、WordPress でどのようなページを表示できるかを見ていきます。

:::message

WordPress で扱うことができるページ種類は多岐に渡りますし、自身で拡張することもできます。ただし本書では、本テーマで使っている基本的なものに絞って説明することにします。詳しく知りたい方は、公式にある「[テンプレート階層](https://developer.wordpress.org/themes/basics/template-hierarchy/)」を参照してください。

:::

### ページの主な種類

ここでは WordPress でよく使われるページ種類を紹介し、本テーマではどのようになっているかを説明していきます。

#### フロントページ（≒ トップページ）

フロントページはサイトの玄関口となるページです。

![フロントページのスクリーンショット](/images/books/web-zukuri/page-index-01.png)

本テーマでは、中央に最新の記事や固定表示設定した記事がカード形式で配置されています。また他と違い、左サイドバーがあるのも特徴です。

#### 固定ページ

固定ページは、ブロックエディタ（※）を使って作成できるページの1つです。後述する投稿ページとの違いとして、下記があります。

- タクソノミー（カテゴリ、タグなど）は設定できない
- 固定ページ間で親子関係を設定できる
- レイアウト毎にページテンプレートを用意すれば、固定ページ単位で使うレイアウトを指定できる

（※ブロックエディタ：WordPress5.0 以降に導入された、記事を編集するための機能です。段落や画像、表などの要素をブロック単位で管理し、直感的なスタイル付をすることができます）

一般的には「会社概要」や「問い合わせページ」、「各種サイトプライバシー」などが固定ページとなります。「ブログ記事」のような、時系列やタクソノミーによる一連の繋がりがあるものは、後述する*投稿ページ*に分類されます。

![固定ページのスクリーンショット](/images/books/web-zukuri/page-page-01.png)

本テーマでは、記事タイトルの下に（エディタで作成した）記事本文がつくという簡易的な形式になっています。  
（GitHub Pages上では暫定的に、テーマ内で使っているコンポーネントを羅列しています）

#### 投稿ページ

投稿ページは、固定ページと同じくブロックエディタを使って作成できるページです。WordPressで投稿した記事を表示するためのレイアウトであり、固定ページと違いタクソノミーを設定できるため、記事同士の繋がりを含めて管理することができます。

一般的に見るブログ記事を表示するためのもの、というイメージで合っていると思います。

![投稿ページのスクリーンショット](/images/books/web-zukuri/page-single-01.png)

本テーマでは固定ページとほとんど同じレイアウトです。一部違うところとして、記事タイトルの後ろに「投稿に関する補足情報（カテゴリ、タグなど）」「サムネイル画像」を出力するようにしています。

#### アーカイブページ

アーカイブページは、年月、カテゴリ、タグ単位での記事一覧を表示するページです。

![アーカイブページのスクリーンショット１](/images/books/web-zukuri/page-archive-01.png)

各記事はカード形式で表示され、1ページに収まらない場合にはページネーション要素が挿入されます。

![アーカイブページのスクリーンショット２、記事群のページ区切りが設けられている](/images/books/web-zukuri/page-archive-02.png)

#### 検索ページ

検索ページは、サイト内を検索するためのページとなります。

![検索ページのスクリーンショット１](/images/books/web-zukuri/page-search-01.png)

ここでは、表示件数と検索キーワードを入力するためのフォームが設置されています。そして検索結果は、カード形式となってフォーム下に一覧表示されます。

1ページに収まらない場合はアーカイブページ同様、ページネーション要素が挿入されます。

![検索ページのスクリーンショット２、記事群のページ区切りが設けられている](/images/books/web-zukuri/page-archive-02.png)

#### 404ページ

404ページは、存在しないページを開こうとした際に表示されます。

![404ページのスクリーンショット](/images/books/web-zukuri/page-404-01.png)

#### （インデックスページ）

このページは他と違って特殊な扱いをします。WordPress では基本的に上記のページ種類のどれかで表示されることになりますが、*どれにも当てはまらない* 場合も考えなければなりません。

用意したページテンプレートのどれにも当てはまらない場合、WordPressは このインデックスページを使ってWebページを生成します。詳細については下記の公式ページをご参照ください。

https://developer.wordpress.org/themes/basics/template-hierarchy/

### ページテンプレートのファイル

上記で、WordPress でよく使われるページについて解説しました。ここからはそれを踏まえ、用意すべきファイルが何なのかを考えていきます。

自作したテーマを動かすために、WordPress は最低限のファイルとして下記を要求します。

- `index.php`：ページテンプレート
- `style.css`：スタイルの規程、テーマに関する情報など
- `functions.php`：機能の実装など

`index.php` は DB から取得したデータをWebページとして出力するためのページテンプレートです。`style.css` はスタイルの規程に使いますが、テーマ名、ライセンス、タグ、バージョンなど テーマに関する情報を記すのにも使います。最後の `functions.php` は WordPress が備える機能をどう使うかや、新たな機能を実装するなどの機能関係で使用します。

`functions.php` に関しては WordPress を本格的に触っていく第三章で解説するので、第二章では残りの２つを主に見ていきます。つまり、ページテンプレートの各種ファイルとスタイルシートです。

#### 用途に応じたページテンプレート

必要最小限のページテンプレートは `index.php` です。これしかページテンプレートがない場合、WordPress はこれを使って全てのページ出力を行います。なので、やろうと思えば `index.php` 上で「投稿ページ」「固定ページ」「検索ページ」などあらゆるケースを踏まえたものにすることができます。

ただし、そうした場合 １ファイルの中身が膨大となりがちです。また後述する方法に比べ複雑度も大幅に増すので、修正にかかる手間が多くなることが予想されます。

WordPress はテンプレートヒエラルキーという構造を取っており、種類に応じたページテンプレートを用意することが許容されています。つまり「投稿ページ」は投稿ページ用のテンプレートで、「検索ページ」は検索ページ用のテンプレートで、といった役割分担が可能と言うことです。

`index.php` の１ファイルで処理する形式の場合は「何でも表示できる万能ファイル」という扱いで用いられますが、テンプレートを分割する上記の場合は「いざという時の緊急用」といった役割がメインとなります。

このテンプレート分割を使って、本テーマで必要となるページテンプレートを考えていきます。前述した[ページ種類](#ページの主な種類)をそのままページテンプレート化する場合、下記のようになります。

- トップページ：`front-page.php`
- 固定ページ：`page.php`（※）
- 投稿ページ：`single.php`（※）
- アーカイブページ：`archive.php`
- 検索ページ：`search.php`
- 404ページ：`404.php`
- その他の汎用ページ：`index.php`

第二章は（特殊な扱いの `index.php` を除いた）これらのファイルの土台を、HTMLファイルで作成していくことが目的となります。

:::message

**※印**の箇所については 中身がほとんど同じなので、第三章では１つのテンプレートファイルに統合します。なので最終的な形は下記のようになります。

- トップページ：`front-page.php`
- 固定/投稿ページ：`singular.php`
- アーカイブページ：`archive.php`
- 検索ページ：`search.php`
- 404ページ：`404.php`
- その他の汎用ページ：`index.php`

「`index.php` から分割しているのに、なぜそこだけ統合しているのか？」については、程度の問題と思いますので確たる答えはありません。

私なりの考えですが、後述する**テンプレートパーツ**（ページ間で同じ構成の部品をテンプレート化し、流用しやすくする仕組み）を踏まえて、中身がどれだけ 離れているか（または近いか）が、分割するか統合するか の指針になると考えています。

:::

:::message alert

※本テーマでは GitHub Pages を利用する関係で、トップページのファイル名は `index.html` でなければなりません。なので `front-page.php` の土台となるHTMLファイルは `index.html` となります。

汎用ページとなる `index.php` の雛形はHTMLでは作成しません。これは説明したように汎用的なページであり、HTMLで表現することはできないためです。

:::

## まとめ

本項では、WordPress の仕組みを踏まえて用意すべきページテンプレートについて考えていきました。

次項ではこれに加えて*テンプレートパーツ*の話をし、そこから用意するHTMLファイルについて説明します。
