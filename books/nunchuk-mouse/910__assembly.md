---
title: "⭐附録：組み込み例🚧"
---

## はじめに

本項では、[リポジトリ](https://github.com/nonaka101/nunchuk-mouse)を実際に活用する例を紹介します。

:::message alert

ここに掲載した内容は、あくまで私自身の検証内容を記載したものです。

本項では実際に Arduino と PC を接続していますが、扱いを誤ると、最悪の場合 PC の故障に繋がります。運用の際は、ご自身で調べた上で行うことを強く推奨いたします。

**本件の内容で生じたトラブル等については、一切の責任は負いかねる**ことを承知の上、ご参照ください。

:::

## 実際にマウスとして利用する場合

下図は、本リポジトリの開発及び検証機です。ただ 動作を見ることができれば良かったので、見栄え等は気にせずジャンプワイヤを端子に直接刺しています。また開発ボードは、大型（Arduino Leonardo）のものを使っています。

![動作検証機。Arduino Leonardo とブレッドボードを使い、コントローラーと接続している。幅としては15センチの大きさ](/images/books/nunchuk-mouse/prototype-01.png)

一方で実際にマウスとして使う場合を考えると、上図のままでは不便です。

- いつジャンプワイヤが外れてもおかしくない
- 見た目が不格好
- 開発ボードをどこに置くかで操作に制限がかかりそう

この段落では、実際にマウスとして利用することを想定し、どのようにすればいいかを考えます。

### 開発ボードの位置について

実際に使うにあたり まず考えるべきは、**開発ボードの位置**でしょう。これが決まれば使用する開発ボードも絞れますし、以降の話の道筋がつきます。

開発ボードの位置をどうするかについては、大きく 2 択になると考えられます。

1. PC に近い位置に配置する
2. コントローラーに内蔵する

#### PC側に配置

まず考えられるのは、[上図にあった検証機](#実際にマウスとして利用する場合)の接続方法を発展させる方法です。端子と開発ボードの接続は はんだ付け等を用いて堅牢にし、ボードも小さくしたりケースに入れたりします。

これのメリットは、コントローラーから伸びているケーブルをそのまま利用できそうなことです。端子をどうするかについては、市販のアダプタで繋いだり、分解してケーブルを剥きボードに はんだ付けする等の選択肢が考えられます。

一方で、デメリットはコントローラーからのケーブル線に長さが制限されやすいことです。開発ボードと PC 間を繋ぐ USB ケーブルを長くするという案もありますが、その場合 中途半端な位置に開発ボードが存在することになります。

#### コントローラーに内蔵

次に考えられる案としては、コントローラーの中に開発ボード自体を埋め込む方法です。

これのメリットは、見栄えがスッキリすることです。コントローラーから直接 USB ケーブルが出ていることになるので、コントローラーと PC 間でゴチャゴチャすることはなくなります。USB ケーブルを長いものにすれば、様々な状況下で扱うことができるでしょう。

一方でデメリットとしては、工数と費用があげられます。内蔵を考えると開発ボードは小さいものである必要がありますし、コントローラーを分解し限られたスペース内で配線して埋め込む作業が発生します。

### 本項での方針

本項では、開発ボードをコントローラー内に内蔵する方向で進めていきます。中古で購入したコントローラーを分解清掃するついでに、中にボードを埋め込もうと思います。

#### 本項で取り扱う開発ボード

本項ではボードを内蔵する関係から、小サイズのものを選択します。Arduino IDE が使え、3.3V で出力可能なものとして、本項では **Adafruit 社の ItsyBitsy 32u4**（3V 8MHz 版）を使います。

https://www.adafruit.com/product/3675

#### 本項の作業で必要となるその他機材

本項の作業で必要となるものについて、特記すべきなのは下記でしょうか。

- はんだ関係
- LED（内蔵する関係でオンボード LED とは別に必要）
- リューター（LED 用の穴あけ、ボード埋め込みスペース確保のための削り 等）

:::message

他にもテスターやケーブルなど様々ありますが、ここでは割愛させてもらいます。

:::

## 分解した際の記録

ここではコントローラーを分解した時の記録図を掲載しています。

![コントローラーを部品単位に分解し並べた図](/images/books/nunchuk-mouse/parts-all-01.png)

:::details 組み付け状態

各部品を詳細に見ていく前に、まずは基板が外装に組み込まれた状態を確認します。コントローラーの中には制御するための基板があり、下図のように収まっています。

![真上からコントローラーを見ている図、3つ並んでおり、完成状態、表面の外装を剥がした状態、中の基板も取り除いた状態が写っている](/images/books/nunchuk-mouse/parts-assy-01.png)

斜めから見たものが下図になります。コントローラーの尻尾（？）側にスペースが確保できそうですが、何かを格納するためには リブ[^1] を削る必要がありそうです。

[^1]: リブ（*Rib*）：プラスチック成形品でよく見られる、肉厚を薄くしつつ強度や剛性を確保するための構造

![上図を斜め45°から覗き込んだ図](/images/books/nunchuk-mouse/parts-assy-02.png)

ちなみに、逆側から見たのが下図です。中に入っている基板は、外装であるケースの表裏両方を使って固定されていることがわかります。

![上図を裏返し、ケース表面に組み込まれた状態を写した図](/images/books/nunchuk-mouse/parts-assy-03.png)

:::

:::details 外装部

外装となるケースは、表裏の 2 つで構成されています。両者は Y ネジで、基板を含め固定されます。

![外装表面を、様々な角度から見た図](/images/books/nunchuk-mouse/parts-case-01.png)

![外装裏面を、様々な角度から見た図](/images/books/nunchuk-mouse/parts-case-02.png)

:::

:::details 基板部

中に入っている基板を見ていきます。下図でわかるように、スティック用のセンサーは基板上に固定された状態です。

![基板を真上から見た図](/images/books/nunchuk-mouse/patrs-main-01.png)

上図の基板を 180°ひっくり返したのが下図です。ケーブルが伸びていること、ボタン用のパーツが基板から外れないようになっていることが確認できます。

![上図をひっくり返した状態](/images/books/nunchuk-mouse/patrs-main-02.png)

:::

:::details ケーブル類

接続端子部を分解したのが下図です。

![接続端子部を分解した図](/images/books/nunchuk-mouse/parts-cable-01.png)

![上図を部品単位まで分解した図](/images/books/nunchuk-mouse/parts-cable-02.png)

配線に焦点を当てたのが下図です。**白、赤、黄、緑**のケーブルが、基板から端子まで伸びていることが確認できます。  
（**黒**のケーブルは端子まで伸びておらず、シールド線に繋がっています）

![基板から伸びている5本のケーブル（上図と違い黒色の線が存在している）](/images/books/nunchuk-mouse/parts-cable-03.png)

![接続端子に繋がっている4本のケーブル](/images/books/nunchuk-mouse/parts-cable-04.png)

端子の役割は、以前下図を使って説明しました。  
（※ **上図から反転して見ている**図であることに注意してください）

![コントローラー端子に直接ジャンプワイヤを配線](/images/books/nunchuk-mouse/cabling-02.png)

このことから、配線の色と役割は下表の関係となります。

|色|名称|説明|
|:---|:---|:---|
|緑|SDA|*Serial Data*：データ本体をやり取りするための信号線|
|黄|SCL|*Serial Clock*：一定周期で切り替わるクロック線|
|赤|3.3V|電源線|
|白|GND|電源線（グランド）|

:::

## 作業経過

:::message

この段落は、制作中となっています。完成まで今しばらく お待ち下さい。

:::
