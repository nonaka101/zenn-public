---
title: "📄使い方：概要"
---

## はじめに

本項では、リポジトリがどのようなものかについて説明します。

ここでは具体的な使い方を説明する前段階として、「何ができて」「何を目的としているか」に焦点を当て、説明していきます。

## 概要

本リポジトリは、Arduino を介してコントローラー（Wii ヌンチャク）を PC に繋ぎ、マウスとして機能させるためのものとなります。

https://github.com/nonaka101/nunchuk-mouse

本リポジトリのメリットは、下記の通りです。

1. [環境や状況に縛られないマウス操作が可能](#環境や状況に縛られないマウス操作)
2. [入手性とカスタマイズ性](#入手性とカスタマイズ性)
3. [学習用の教材として](#学習用の教材として)

### 環境や状況に縛られないマウス操作

#### 姿勢の自由度

臥位、座位、立位に関わらず、自由な姿勢で操作することができます。

ベッド上から、ソファに腰掛けた状態から、プレゼンで立った状態から など、様々な状況・姿勢でも直感的に PC を操作することができます。

#### 最小限の動作でマウス機能にアクセス可能

手や体の動きを最小限に抑えた上で、5 ボタンマウス同等の機能にアクセスすることが可能です。

通常のマウスでは、マウスカーソルの移動などで上肢全体を使います。

本リポジトリでは、指（スティック, ボタン）と手首の傾き（モード切替）だけで完結できるよう設計しています。最小限の動作で、一般的な 5 ボタンマウスが提供する下記操作が可能です。

- カーソル移動
- ホイールスクロール
- マウスボタン（左右中）
- 戻る/進む ボタン

機能を手指に集中しているため ある程度の巧緻性は必要となってきますが、OS 側のアクセシビリティ設定や後述する[カスタマイズ](#カスタマイズ性)により、一部を緩和することができるかもしれません。

#### 様々なOSで動作可能

HID (Human Interface Device) として認識するので、専用ソフトのインストール等は不要です。USB ケーブルで PC と Arduino を繋ぐだけで、コントローラーをマウスとして動かすことができます。

HID をサポートしている一般的な OS（Windows, Linux, Mac[^1] など）であれば、動作可能と考えて OK です。

[^1]: MacOS に関してはコード内にある設定項目の変更（カスタマイズ）が必要です。これは「戻る/進む」ショートカットキーが他の OS と異なるためです。

### 入手性とカスタマイズ性

#### 入手性

見栄えを気にしなければ、下記のみで動かすことができます。

- Arduino などの開発ボード（**注意**[^2] [^3] [^4]）
- Wii ヌンチャク（コントローラー）
- USB ケーブル
- 4 本のジャンプワイヤ

[^2]: Arduino 開発ボードは HID サポートされた機種が必要となります。詳しくは[公式ドキュメント](https://docs.arduino.cc/language-reference/en/functions/usb/Keyboard/#compatible-hardware)を参照ください。
[^3]: 互換品である Pro Micro 等でも動作するとは思いますが、検証はしていない状態です。ご了承ください。
[^4]: コントローラーの電源が 3.3V のため、3.3V を出力できるボードを推奨します。

これらは中古で比較的安価に手に入るため、気軽に試してみたり、後述する[学習用教材として](#学習用の教材として)利用しやすいと考えられます。

#### カスタマイズ性

様々な状況を想定し、ユーザーに合った使い心地にできるよう、様々な設定項目を設けています。下記はその一例です。

- スティックや加速度センサーの各種調整
  - 中心軸
  - 可動範囲
  - 平滑処理に使うサンプリング数
- `C`, `Z` ボタンのマウス機能割当
- モード切替条件となる向きや精度
- カーソルやホイールの移動量
- 逆スクロールのオン/オフ

こうした設定を調整することで、ユーザーごとに異なる 姿勢や利き手といった事情に対応し、自身の好みに合わせたカスタマイズをすることができます。

また HID として OS 上は認識されるので、OS 側の設定（マウスやアクセシビリティなど）と組み合わせることで より利便性を上げることができるかもしれません。

### 学習用の教材として

本リポジトリは、Arduino 初心者が作成したものになります。そのため同じような方には、学習教材としても利用できるかもしれません。

コードの中では、下記の内容を取り扱っています。

- I2C 通信を使って、センサー等から情報を取得する
- データを扱いやすい形に処理する（平滑化、オフセット）
- 扱うデータを構造体にまとめる
- 加速度情報からデバイス向きを算出する
- 少ない物理機能に対し、状態管理（モード切替）で割当数を増やす

#### 更なる改良

コードは開発した状態のままにしてあります。効率のための軽量化等は行っておらず、コメント等は開発時のままにしています。

また、更なる機能追加ができるよう設計を考えているので、これをベースとして更なる改良を行うこともできるかもしれません。

例：ジェスチャー機能（「素早く振る」といった動作）を使って、特定のショートカットに割り当てる

## 操作方法

ここでは PC に接続した際の操作方法を説明します。PC 接続までについては、後述の「[📄使い方：必要となる機材等](./120__hardware-required)」以降を参照ください。

### 2つのモードによる機能切替

コントローラーの物理機能（スティック、ボタン、加速度）を使い、5 ボタンマウスと同等の機能を提供します。

物理機能の少なさを解消するために、コントローラーに搭載された加速度センサーを利用します。特定の向き（デフォルトでは *Pitch Up*）でモードを切り替えることで、1 つの物理機能に複数のマウス機能を振り分けています。

![コントローラー6方向の図](/images/books/nunchuk-mouse/axis-01.png)

#### カーソルモード

通常の持ち方ではカーソルモードとなります。

##### スティックでカーソル移動

カーソルモード時は、スティック操作でカーソル移動できます。

##### 2つの物理ボタンでマウスボタン操作

（デフォルト設定では）C ボタンはマウス左ボタン、Z ボタンはマウス右ボタンとして機能します。マウスボタンは一般のマウス同様、ダブルクリックやドラッグ操作が可能です。

#### ホイールモード

特定の向き（デフォルトでは *Pitch Up*）でホイールモードに移行し、各種物理機能の役割が変わります。

##### スティックでホイール移動および戻る/進むボタン

ホイールモードでは、スティックはホイール移動と「戻る」「進む」ボタンとして機能します。

- スティック上下でホイール移動
- スティック左右で「戻る」「進む」

##### 異なるマウスボタン

（デフォルト設定では）C ボタンはマウス左ボタン、Z ボタンはマウス中ボタンとして機能します。

#### LEDで状態を通知

通常 Arduinoは、自由に使える LED が内蔵（オンボード）されています。

:::message

Arduino 純正ボード外（例：Pro Micro）を使用する場合や、オンボードでない LED を使用したい場合には、設定でピン番号を切り替える作業が必要かもしれません。

:::

この LED を使い、下記のモードや状態を通知します。

##### ホイールモード時は点灯

ホイールモード（特定の向きにデバイスを向けた状態）では、モードが切り替わったことを知らせるために **LED が点灯**します。

##### エラー時は点滅

何かしらのエラーなどでコントローラーとの接続ができなくなると、**LED が 点滅**します。

## まとめ

本項では、リポジトリについての概要について説明しました。

- リポジトリの内容及び特徴
- 操作方法
- どのように活用するか

次項では、必要となる機器について解説します。
