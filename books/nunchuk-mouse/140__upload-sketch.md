---
title: "📄使い方：スケッチをボードに書き込む"
---

## はじめに

本項では、Arduino と PC を接続し、コード（スケッチ）をボード上に書き込む作業を行います。

これによりコントローラーがマウスとして認識され、最低限の機能を果たすようになります。

## 機器の接続（Arduino ↔ PC）

[前項](./130__connect-device)にて、コントローラーと Arduino の接続ができました。ここからは Arduino と PC を接続する作業を説明していきます。

### Arduino IDE を起動

接続する前にまず、[公式ホームページ](https://www.arduino.cc/en/software/)等からインストールした Arduino IDE を起動させます。

### Arduino を PC に接続

IDEが立ち上がったら、USBケーブルを使い Arduino と PC を接続します。

IDE 上でボードが認識されたことを確認してください。

![IDEを立ち上げ、Arduinoを接続し認識した状態](/images/books/nunchuk-mouse/ide-01.png)

:::message

自動的に認識されない場合、「ツール」→「ボード」から対応するボードを選択します。

純正でない互換ボードの場合は、下記の作業が必要かもしれません。詳しくはお使いのボードの説明書等を参照してください。

1. 「Arduino」→「Preferences...」から、ボードマネージャーで互換ボードを扱うための URL を追加
2. 「ツール」→「ボード」→「ボードマネージャー」から、対応するボードを選択

:::

### スケッチを作成

[リポジトリ](https://github.com/nonaka101/nunchuk-mouse) にある `nunchuk-mouse.ino` をボードに書き込みます。

ファイルをダウンロードして IDE で開いてもいいですし、コード文をコピーして IDE 上の新規スケッチにペーストしても構いません。

### 検証と書き込み

ボードに書き込む前に、一度コンパイルを通して問題ないかを検証しておきます。

![IDE操作画面](/images/books/nunchuk-mouse/ide-02.png)
*`✓` で Verify（確認する）*

問題がなければ、ボードに書き込みを指示します。

![IDE操作画面](/images/books/nunchuk-mouse/ide-03.png)
*`→` で Upload（書き込み）*

### 問題がなければマウスとして機能

ボードに書き込みが終わったら、コントローラーをマウスとして使えるようになります（起動に数秒程度かかる場合があります）

ここからは、動作に問題がないかを確認していきます。

:::message

ここからは持ち方によってモードが切り替わるので注意してください。

|モード名|持ち方|識別方法（ボード上の LED）|
|:---|:---|:---|
|**カーソルモード**|通常時の状態です。ホイールモードの持ち方以外で、このモードになります|消灯|
|**ホイールモード**|デフォルト設定では、コントローラーを立てる（下図の *Pitch Up*）状態で、このモードになります|点灯|

![コントローラー6方向の図](/images/books/nunchuk-mouse/axis-01.png)

:::

:::message alert

しばらく待ってもコントローラーが反応せず、**ボード上の LED が点滅状態**にある場合、**接続エラー**が起きています。その際は下記を確認してください。

- 配線やコードが間違っていないか
- コントローラーやボードは適正なものを使用しているか

:::

#### カーソルモード

カーソルモード（通常時の持ち方：スティックが天井方向を向いている状態）での各種機能を確認していきます。

##### カーソル移動

スティックを傾けると、マウスカーソルが連動して移動します。

##### マウス左右ボタン

C ボタンでマウス左ボタン、Z ボタンでマウス右ボタンとして機能します。押す長さにより、ダブルクリックやドラッグ操作も可能です。

#### ホイールモード

ホイールモード（デフォルトの設定では**コントローラーを立てる**：物理ボタンが天井方向を向いた状態）での各種機能を確認していきます。

##### ホイール移動

スティックの上下が、ホイール移動として機能します。

##### 戻る/進む機能

スティックの左右で、ブラウザ等の「戻る」「進む」機能を利用できます。

##### マウス左中ボタン

C ボタンでマウス左ボタン、Z ボタンでマウス中ボタンとして機能します。押す長さにより、ダブルクリックやドラッグ操作も可能です。

## まとめ

本項では Arduino と PC を接続し、最低限の機能が利用できるようになるまで整備しました。

デバイス向きを変えることで、カーソル ↔ ホイール モード間を行き来でき、どのような姿勢でもマウス操作が可能となります。

次項では、本項で用意したデフォルト設定の状態を、ユーザー自身の好みに合わせた形に調整する方法について説明します。
